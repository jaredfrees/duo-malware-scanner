#include <sys/syscall.h>

#include <unistd.h>
#include <stdlib.h>
#include <stdio.h>

#define HIJACKED_SYSCALL __NR_tuxcall
#define HIJACKED_SYSCALL_MEM __NR_mlockall

char buffer[40];

int foo = 43;


int main(int argc, const char* argv[]) 
{
  //printf("Hello user\n");
  
  char str[] = "gedit";

  printf("Call syscall at offset %d\n", HIJACKED_SYSCALL);
  printf("Syscall return %ld\n", syscall(HIJACKED_SYSCALL, str));
  
  printf("Call syscall at offset %d\n", HIJACKED_SYSCALL_MEM);
  printf("Syscall return %ld\n", syscall(HIJACKED_SYSCALL_MEM, str));
  
  return 0;
}

/*
int main(int argc, char* argv[])
{
  // char *string;

  printf("Call syscall at offset %d\n", HIJACKED_SYSCALL);
  // string = argc > 1 ? argv[1] : "Foo";
  printf("Virtual address @%p\n", &foo);
  snprintf(buffer, sizeof(buffer), "%lx", (size_t)(&foo));
  printf("Syscall return %lx\n", syscall(HIJACKED_SYSCALL, buffer));
  return 0;
}
*/

