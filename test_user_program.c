#include <sys/syscall.h>

#include <unistd.h>
#include <stdlib.h>
#include <stdio.h>

#define HIJACKED_SYSCALL_TASK_SCANNER __NR_tuxcall
#define HIJACKED_SYSCALL_KILL_PROCESS __NR_mlockall

int main(int argc, const char* argv[]) 
{
  
  char str[] = "gedit";

  //printf("Call syscall at offset %d\n", HIJACKED_SYSCALL_TASK_SCANNER);
  printf("Syscall return %ld\n", syscall(HIJACKED_SYSCALL_TASK_SCANNER, str));
  
  //printf("Call syscall at offset %d\n", HIJACKED_SYSCALL_KILL_PROCESS);
  printf("Syscall return %ld\n", syscall(HIJACKED_SYSCALL_KILL_PROCESS, str));
  
  return 0;
}


