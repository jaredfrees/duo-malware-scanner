#include "header.h"

void main(){
	char userInput;
	printf("WELCOME TO THE FREES-ELLISON DUO MALWARE SCANNER!\n\n");
	printf("This program allows you to scan and delete malicious programs off your device\n");
	printf("This program does the following:\n");
	printf("\t-Scans current running processes for malware based on keyword\n");
	printf("\t-Scans memory for malware based on keyword\n");
	printf("\t-Scans System Call and Interrupt tables for malware based on keyword\n\n");
	printf("Please input one of the following commands:\n");
	printf("\tScan Current Running Processes [p]\n");
	printf("\tScan System Memory [m]\n");
	printf("\tScan System Call Table [s]\n");
	printf("\tScan Interrupt Table [i]\n");
	printf("\tExit Program [q]\n");
	scanf("%c\n", &userInput);
	while(userInput != 'q'){
		switch(userInput){
			
			case 'p':
				pthread_t procScan;
				String keyword;
				printf("Please enter a keyword: ");
				scanf("%s\n", &keyword);
				pthread_create(&procScan, NULL, ScanProc, (void*)keyword);
				break;
			case 'm':
				break;
			case 's':
				break;
			case 'i':
				break;

			default:
				printf("NOT A VALID COMMAND!\n");
				
				break;
									
		}
		printf("Please input one of the following commands:\n");
		printf("\tScan Current Running Processes [p]\n");
		printf("\tScan System Memory [m]\n");
		printf("\tScan System Call Table [s]\n");
		printf("\tScan Interrupt Table [i]\n");
		printf("\tExit Program [q]\n");
		scanf("%c\n", &userInput);	
	}

}
