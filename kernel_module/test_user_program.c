#include <sys/syscall.h>

#include <unistd.h>
#include <stdlib.h>
#include <stdio.h>

#include "shared_header.h"

#define HIJACKED_SYSCALL_TASK_SCANNER __NR_tuxcall //184
#define HIJACKED_SYSCALL_KILL_PROCESS __NR_mlockall //151

int main(int argc, const char* argv[]) 
{
  
  char str[] = "chrome";

  printf("Call syscall at offset %d\n", SYSCALL_TASK_SCANNER);
  printf("Syscall return %ld\n", syscall(SYSCALL_TASK_SCANNER, str));
  
  printf("Call syscall at offset %d\n", SYSCALL_KILL_PROCESS);
  printf("Syscall return %ld\n", syscall(SYSCALL_KILL_PROCESS, str));
  
  return 0;
}


