static int is_syscall_table(ulong *p);

static unsigned long scan_syscalls(int syscall_num) {
  unsigned long *syscall_table;
  void *indv_syscall;
  int i;
  
  syscall_table = (ulong *)kallsyms_lookup_name(SYS_CALL_TABLE);
  
  if (is_syscall_table(syscall_table)) { 
    printk(KERN_INFO "System call Table Address: %p\n", syscall_table);
    printk(KERN_INFO "Memory Address of System Calls 0-%d:", END_SYSCALL_NUM); 
    for (i = 0; i <= END_SYSCALL_NUM; i++){
      indv_syscall = (void *)syscall_table[i];
      printk(KERN_INFO "System Call #%d: %p\n", i, indv_syscall); 
    }
    printk("-END SYSTEM CALL PRINTING-\n");
    return 0;
  } else {
    printk("System Call Table Address Not Found\n");
    return -1;
  }
}



