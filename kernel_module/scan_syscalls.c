static unsigned long scan_syscalls(const char* str) {
  // The struct used for info of a process
  struct task_struct* task;
  
  char keyword[MAX_INPUT_SIZE];
  
  int numFound = 0;
  
  if (copy_from_user(keyword, str, MAX_INPUT_SIZE)) {
    return -EFAULT;
  }
  //terminate string with null character
  keyword[MAX_INPUT_SIZE-1] = 0;
  
  print_string("Processes matching keyword:");
    
  // Go over through the list of processes
  for_each_process(task) {
    if (!(strcmp((task->comm), keyword))) {
      numFound++;
      printk("Matching process #%d: \"%s\" with PID: %d\n", numFound, task->comm, task->pid);
      print_string((task->comm));
    }   
  }
  if (!numFound) {
    printk(KERN_INFO "No processes found matching keyword: \"%s\"\n", keyword);
    print_string("No processes found matching keyword.");
  }
  
  return numFound;
}
